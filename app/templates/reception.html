{% extends "base.html" %}
{% block content %}
	<script type="text/javascript">
		$(document).ready(function()
		{
			$("#usermodal").css("height:400px");
			$(".userrow").click(function(){
				selectedUserID = $(this).find('.userid');
				$("#usermodal").show();
			});
			function closeModal(){
				$("#usermodal").hide();
			}
			updateTime();
			window.setInterval(updateTime, 1000);
		    function updateTime(){
		    	var date = new Date();
		    	var dateTime = document.getElementById("datetime");
		    	dateTime.innerHTML = date.toDateString() + " - " + date.toTimeString();
		    }
		});
	</script>
	<div id="changeReader" class="modal fade" role="dialog">
      	<div class="modal-dialog">
	        <div class="modal-content">
	          	<div class="modal-header">
	            	<button type="button" class="close" data-dismiss="modal">&times;</button>
	            	<h4 class="modal-title">Change Card Reader</h4>
	        	</div>
		        <div class="modal-body">
			        <table class="table table-striped">
				        <thead>
				        	<tr>
				        		<th>Reader</th>
				        		<th>Status</th>
				        	</tr>
				        </thead>
				        <tbody>
				            {% for reader in readers %}
				            <tr>
				            	<td>
				            	{% if loop.index0 == currentReader %}
				            		<button type="button" class="btn btn-success btn-block">{{ reader.name }}</button>
				            	{% else %}
				            		<button type="button" class="btn btn-primary btn-block">{{ reader.name }}</button>
			            		{% endif %}
			            		</td>
			            		{% if reader.status == 0 %}
									<td style="color:gray">Inactive</td>
								{% elif reader.status == 1 %}
									<td style="color:green">Active</td>
								{% else %}
									<td style="color:#ff0000" class="flash250">TAMPER</td>
								{% endif %}
				            </tr>
		            		{% endfor %}
	            		</tbody>
	        		</table>
		        </div>
		        <div class="modal-footer">
		            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
		        </div>
    		</div>
    	</div>
	</div>
	<div class="panel-group">
		{% if user.access == 4 or user.access == 99 %}
		<div class="panel panel-info">
	        <div class="panel-heading text-center"><h2>Reception Desk</h2></div>
	        <div class="panel-body text-center">
        		<h2 id="datetime"></h2>
	        	Current card reader: <strong>{{ readers[currentReader].name }}</strong><br><br>
				<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#changeReader">Change Card Reader</a>
	  		</div>
	  	</div>
		<div class="panel panel-info">
	        <div class="panel-heading text-center"><strong>Add/Remove Guests</strong></div>
	        <div class="panel-body text-center">
				<form action="#" method="post" name="guestlogin" class="form-inline">
	  				{{ createGuestForm.hidden_tag() }}
	  				<div class="form-group">
	  					<label>{{ createGuestForm.username.label }}: </label>
	            	 	{{ createGuestForm.username(size=28) }}
	            	</div>
 	  				<div class="form-group">
	  					<label>{{ createGuestForm.expires.label }}: </label>
						{{ createGuestForm.expires }}
					</div>
	        		<button type="submit" class="btn btn-primary">Create Guest</button>
    			</form>
			</div>
		</div>
		<div class="panel panel-info">
	        <div class="panel-heading text-center"><strong>Manual Check In</strong></div>
	        <div class="panel-body text-center">
				<form action="#" method="post" name="checkin">
	  				{{ manualCheckInForm.hidden_tag() }}
	  				<div class="form-group">
	  					<label>{{ manualCheckInForm.username.label }}: </label><br>
	  					{{ manualCheckInForm.username(size=28) }}
	  				</div>
	  				<div class="form-group">
	  					<label>{{ manualCheckInForm.facid.label }}: </label><br>
	  					{{ manualCheckInForm.facid }}
	  				</div>
	  				<div class="form-group">
	  					<label>{{ manualCheckInForm.cardid.label }}: </label><br>
	  					{{ manualCheckInForm.cardid }}
	  				</div>
	  				<button type="submit" class="btn btn-primary">Check In</button>
    			</form>
			</div>
		</div>
		{% endif %}
	</div>
{% endblock %}